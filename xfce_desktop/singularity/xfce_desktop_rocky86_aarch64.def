Bootstrap: library
#From: rockylinux:latest
From: rockylinux:8.6

%post
        dnf -y install hostname gcc gcc-gfortran gcc-c++ perl java vim emacs zsh git cmake numactl libcgroup boost boost-devel
        dnf -y install epel-release dnf-plugins-core wget
        dnf config-manager --set-enabled powertools
        dnf -y install xorg-x11-apps hostname evince eog glx-utils systemd-libs sssd python2-pip Lmod xdg-user-dirs
	dnf -y install mesa-libGLU hwloc-libs lm_sensors-libs libXp ghostscript gedit gedit-plugins
        #
        dnf --skip-broken -y groupinstall 'Development Tools' 'Base' 'Infiniband Support' 'Xfce' 'base-x' 'Internet Browser'
        pip2 install ts
        dnf install -y https://yum.osc.edu/ondemand/latest/compute/el8Server/x86_64/python-websockify-0.8.0-1.el8.noarch.rpm
        dnf -y install libX11-devel libXi-devel libXt-devel pam-devel java-1.8.0-openjdk-devel
        wget https://github.com/libjpeg-turbo/libjpeg-turbo/archive/refs/tags/2.1.3.tar.gz
        tar xfz 2.1.3.tar.gz
        cd libjpeg-turbo-2.1.3
        cmake -G"Unix Makefiles" -DCMAKE_INSTALL_PREFIX=/opt/libjpeg-turbo -DWITH_JAVA=1
        make install
        cd ../
        rm -rf 2.1.3.tar.gz libjpeg-turbo-2.1.3
        wget https://github.com/TurboVNC/turbovnc/archive/refs/tags/2.2.3.tar.gz
        tar xfz 2.2.3.tar.gz
        cd turbovnc-2.2.3
        cmake -G"Unix Makefiles" -DCMAKE_INSTALL_PREFIX=/opt/TurboVNC
        make install
        cd ../
        rm -rf 2.2.3.tar.gz turbovnc-2.2.3
        dnf remove -y python2-pip xfce4-screensaver
        update-alternatives --set python /usr/bin/python3
        #
        dnf install -y paraview paraview-devel paraview-mpich-devel paraview-openmpi-devel paraview-doc qt5-devel protobuf-devel
        #
        dnf clean all
